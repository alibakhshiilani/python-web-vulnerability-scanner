import argparse
import scanner
import config

def parse_args():
    parser = argparse.ArgumentParser()
    parser.add_argument('--url', help='URL to scan')
    parser.add_argument('--report', help='Report file to write to')
    parser.add_argument('--methods', nargs='+', help='HTTP methods to use')
    parser.add_argument('--payloads', nargs='+', help='Payload files to use')
    return parser.parse_args()


if __name__ == '__main__':
    args = parse_args()

    if args.url:
        url = args.url
    else:
        url = config.URL

    if args.report:
        config.REPORT_FILE = args.report

    if args.methods:
        config.METHODS = args.methods

    if args.payloads:
        payloads = []
        for payload in args.payloads:
            payloads += load_payloads(payload)

    scanner = Scanner(url)
    scanner.scan()